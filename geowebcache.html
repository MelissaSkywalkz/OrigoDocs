<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GeoWebCache</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="main.css">
</head>
<body class="layout">
  <nav class="sidenav" id="sidenav" aria-label="Sidomeny">
    <div class="sidebar-header">
      <a href="index.html" class="logo" aria-label="Till startsidan">>_ Origo Docs</a>
    </div>
    <div class="nav-search">
      <input
        type="search"
        id="navSearch"
        placeholder="Sök i GIS-handboken…"
        aria-label="Sök"
      />
      <ul id="searchResults" class="search-results hidden"></ul>
    </div>
    <div class="nav-content">
      <div class="nav-section">
        <button class="accordion-button" aria-expanded="true" aria-controls="nav-docs">
          Dokumentation
        </button>
        <div class="accordion-panel" id="nav-docs">
          <a href="index.html">Start</a>
          <a href="page.html">JSON 101</a>
          <a href="origo-guide.html">Origo guide</a>
          <a href="layermanager.html">Layermanager</a>
          <a href="geoserver.html">GeoServer 101</a>
          <a href="geoserver-styles.html">GeoServer styles</a>
          <a href="geowebcache.html" aria-current="page">GeoWebCache</a>
          <a href="origo-server.html">Origo Server</a>
          <a href="#tile-cache-101">Tile cache 101</a>
          <a href="#seed-truncate-bypass">Seed/Truncate</a>
          <a href="#crs-gridset">CRS & gridsets</a>
          <a href="#grid-misalignment">Grid misalignment</a>
          <a href="#seed-strategi">Seed‑strategi</a>
          <a href="#felsokningsflode">Felsökningsflöde</a>
          <a href="#cacheability">Cacheability</a>
          <a href="git-vscode.html">Git & VS Code</a>
          <a href="examples.html">Origo-recept</a>
          <a href="faq-gis.html">FAQ GIS</a>
          <a href="npm.html">npm & plugins</a>
          <a href="release-playbook.html">Release‑playbook</a>
          <a href="troubleshooting.html">Felsökning</a>
        </div></div>
      </div>
      <div class="nav-section">
        <button class="accordion-button" aria-expanded="false" aria-controls="nav-shortcuts">
          Snabblänkar
        </button>
        <div class="accordion-panel" id="nav-shortcuts" hidden>
          <a href="https://docs.geoserver.org/">GeoServer Docs (extern)</a>
          <a href="https://origo-map.github.io/origo-documentation/latest/#origo-map">Origo Docs (extern)</a>
        </div></div>
      </div>
    </div>
  </nav>

  <div class="nav-backdrop" hidden></div>

  <main class="main" id="main">
    <header class="topbar">
      <button class="nav-toggle" data-nav-toggle aria-label="Öppna eller stäng meny" aria-expanded="true">
        <img src="sort.png" alt="" />
      </button>
      <div class="topbar-title">
        <span class="eyebrow">GeoServer</span>
        <h1>GeoWebCache</h1>
      </div>
      <div class="topbar-meta">
        <span class="status-pill">Drift</span>
      </div>
    </header>

    <section class="wizard" data-wizard="geowebcache"></section>

    <section class="doc-content">
      <h2 id="tile-cache-101">Tile cache 101</h2>
      <p>
        GeoWebCache är tile-cachen som sitter nära GeoServer. Den lagrar kartbilder som små tiles
        så att klienten (Origo) får snabba svar vid pan/zoom.
      </p>

      <h2 id="geoserver-koppling">Hur GeoWebCache hänger ihop med GeoServer</h2>
      <ul>
        <li>GeoServer renderar kartan.</li>
        <li>GeoWebCache sparar resultatet som tiles.</li>
        <li>Klienten hämtar tiles i stället för att rendera om varje gång.</li>
      </ul>

      <h2 id="begrepp">Begrepp (enkelt)</h2>
      <ul>
        <li><strong>Gridset / tiling scheme:</strong> hur tiles delas upp (t.ex. 256x256).</li>
        <li><strong>Seed:</strong> förgenerera tiles i förväg.</li>
        <li><strong>Metatiles:</strong> större tile-bitar för effektiv rendering.</li>
      </ul>
      <ul>
        <li><strong>Truncate:</strong> rensa cache för ett lager eller område.</li>
        <li><strong>Bypass:</strong> kringgå cache vid felsökning.</li>
      </ul>

      <h2 id="seed-truncate-bypass">Seed / Truncate / Bypass: skillnaden</h2>
      <ul>
        <li><strong>Seed:</strong> bygger nya tiles (snabbare första visning).</li>
        <li><strong>Truncate:</strong> tar bort gamla tiles (kräver ny rendering).</li>
        <li><strong>Bypass:</strong> går förbi cache för att se “live” rendering.</li>
      </ul>
      <div class="callout callout-warn">
        <strong>Vanligt misstag</strong>
        Att seeda allt på alla zoomnivåer. Välj hellre relevant område och nivåer
        för att undvika långa körningar.
      </div>

      <h2 id="crs-gridset">CRS & gridsets</h2>
      <p>
        Gridset måste matcha kartans CRS. Om gridset/CRS inte stämmer får du fel placering
        eller tomma tiles. Vår vanligaste CRS är EPSG:3008.
      </p>
      <p>
        Tänk så här: CRS styr hur världen delas upp i zoomnivåer. Gridset och resolutions måste
        därför hänga ihop med samma projektion och samma extent.
      </p>

      <h2 id="grid-misalignment">Grid misalignment</h2>
      <ul>
        <li><strong>Symptom:</strong> tiles hamnar fel, skuggförskjutning, tomma rutor vid vissa zoom.</li>
        <li><strong>Orsak:</strong> fel gridset, fel tile size eller blandade CRS.</li>
        <li><strong>Åtgärd:</strong> verifiera gridset/matrixset, matcha resolutions och seed om.</li>
      </ul>

      <h2 id="gridset-origin">Gridset, origin och matrixset</h2>
      <ul>
        <li>Origin påverkar tile-alignment. Fel origin ger offset.</li>
        <li>Kontrollera att matrixset matchar gridset och CRS.</li>
        <li>Verifiera att samma gridset används i klient och cache.</li>
      </ul>

      <h2 id="seeding-rest">Seeding och REST-anrop</h2>
      <ul>
        <li>Seed kan misslyckas om REST-payload är felaktig.</li>
        <li>Testa seeding med små BBOX och få zoomnivåer.</li>
        <li>Kommunikationsfel syns ofta i GeoServer-loggar.</li>
      </ul>
      <h2 id="seed-strategi">Seed‑strategi</h2>
      <ul>
        <li>Seed per område och per zoomintervall, inte allt samtidigt.</li>
        <li>Använd metatiles för jämnare rendering.</li>
        <li>Börja med lägre zoomnivåer och bygg ut stegvis.</li>
      </ul>

      <h2 id="cacheability">Cacheability och parametrar</h2>
      <ul>
        <li>Filter och viewparams gör att cache inte kan återanvändas.</li>
        <li>Undvik dynamiska parametrar för lager som ska cacheas.</li>
        <li>Testa samma request utan filter för att jämföra.</li>
      </ul>

      <h2 id="metastore-disk">Metastore och disk quota</h2>
      <ul>
        <li>Disk quota kan stoppa seeding om cache-disken är full.</li>
        <li>Rensa endast cache-kataloger, inte konfig.</li>
        <li>Metastore går ofta att återskapa om cache rensas korrekt.</li>
      </ul>

      <h2 id="checklista">Praktisk checklista</h2>
      <ol>
        <li>Använd cache för publika bakgrundskartor och statiska lager.</li>
        <li>Seeda bara de zoom-nivåer som faktiskt används.</li>
        <li>Rensa cache när stilen eller datan ändras.</li>
      </ol>
      <ol>
        <li>Rensa inte cache i onödan. Det är dyrt.</li>
        <li>Seeda hellre smala områden än hela världen.</li>
        <li>Testa alltid visuellt i Origo efter ändring.</li>
      </ol>

      <div class="callout callout-warning">
        <h3 id="stale-tiles">Stale tiles</h3>
        <p>Om du ser gamla kartbilder, rensa cache eller ändra tile-URL för cache-busting.</p>
      </div>
      <div class="callout callout-warning">
        <h3 id="vanliga-misstag">Vanliga misstag</h3>
        <ul>
          <li>Rensa cache i live utan plan.</li>
          <li>Seeda för många zoom‑nivåer samtidigt.</li>
          <li>Fel gridset för CRS.</li>
        </ul>
      </div>

      <h2 id="felsokningsflode">Felsökningsflöde</h2>
      <ul>
        <li><strong>Gamla tiles:</strong> truncate cache och testa ny seed.</li>
        <li><strong>Tomma tiles:</strong> kontrollera bbox/extent och att lagret är publicerat.</li>
        <li><strong>Tung rendering:</strong> minska zoomintervall och seeda mindre område.</li>
        <li><strong>Extern WMS långsam:</strong> testa bypass och seeda bara nödvändigt.</li>
        <li><strong>Fel zoomnivå:</strong> kontrollera resolutions och gridset.</li>
      </ul>

      <h2 id="klientperspektiv">Klientperspektiv (Origo + browser)</h2>
      <ul>
        <li>Kontrollera Network-fliken: ser du tiles (.png/.jpeg)?</li>
        <li>Granska cache headers (t.ex. <code>Cache-Control</code>).</li>
        <li>Hård reload (Ctrl/Cmd + Shift + R) för att kringgå lokal cache.</li>
      </ul>

      <pre><code># exempel: cache-busting
https://geoserver.example.com/geoserver/gwc/service/wms?layer=workspace:layer&v=2026-01-25
</code></pre>

    </section>
  </main>

  <script src="main.js"></script>
</body>
</html>
